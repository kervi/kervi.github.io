

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>GPIO</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="" href="index.html"/>
        <link rel="next" title="Displays" href="display.html"/>
        <link rel="prev" title="Motors" href="motors.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Kervi
          

          
          </a>

          
            
            
              <div class="version">
                0.20.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getstarted/index.html">Get started</a></li>
<li class="toctree-l1"><a class="reference internal" href="dashboards.html">Dashboards</a></li>
<li class="toctree-l1"><a class="reference internal" href="sensors.html">Sensors</a></li>
<li class="toctree-l1"><a class="reference internal" href="controllers.html">Controllers</a></li>
<li class="toctree-l1"><a class="reference internal" href="signals.html">Signal handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="actions.html">Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="camera.html">Camera and video</a></li>
<li class="toctree-l1"><a class="reference internal" href="motors.html">Motors</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">GPIO</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#gpio-main-board">GPIO main board</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pull-up-down">Pull up/down</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bounce">Bounce</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pwm">PWM</a></li>
<li class="toctree-l2"><a class="reference internal" href="#other-gpio-devices">Other GPIO devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scheduling">Scheduling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#linking-to-dashboards">Linking to dashboards</a></li>
<li class="toctree-l2"><a class="reference internal" href="#linking-to-controllers">Linking to controllers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#linking-to-actions">Linking to actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#action-interrupts">Action interrupts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="display.html">Displays</a></li>
<li class="toctree-l1"><a class="reference internal" href="messaging.html">Messaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="hal.html">Hardware and devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="devices/index.html">Device library</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_process.html">Process distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributed.html">Distributed applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="service.html">Run as service</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Commandline tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="ipc.html">Interprocess communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins/index.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="kervi_api.html">Kervi API</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Contribute</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Kervi</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>GPIO</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>GPIO<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>Kervi standardize access to GPIO (general-purpose input/output).
It is possible to link GPIO pins to dashboards, controllers and actions</p>
<div class="section" id="gpio-main-board">
<h2>GPIO main board<a class="headerlink" href="#gpio-main-board" title="Permalink to this headline">¶</a></h2>
<p>Access to the mainboard (Raspberry PI) GPIO is done via the kervi.hal module. When your Kervi application starts it scans
for installed Kervi platform drivers and loads the GPIO driver.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">kervi.application</span> <span class="kn">import</span> <span class="n">Application</span>
    <span class="n">APP</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>

    <span class="c1">#Get access to main board GPIO</span>
    <span class="kn">from</span> <span class="nn">kervi.hal</span> <span class="kn">import</span> <span class="n">GPIO</span>

    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">define_as_input</span><span class="p">()</span>

    <span class="c1">#Link to dashboard it will show as a read only switch.</span>
    <span class="c1">#If the the GPIO 21 pin is set high, the switch will change to on.</span>
    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">link_to_dashboard</span><span class="p">()</span>

    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio20&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">define_as_output</span><span class="p">()</span>
    <span class="c1">#Link to dashboard it will show as a switch</span>
    <span class="c1">#Press the button on screen to turn the GPIO pin 20 high</span>
    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio10&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">link_to_dashboard</span><span class="p">()</span>

    <span class="n">APP</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="pull-up-down">
<h2>Pull up/down<a class="headerlink" href="#pull-up-down" title="Permalink to this headline">¶</a></h2>
<p>When a gpio pin is not connected electrically to a low og hi signal it may float at take arbitrary values.
To avoid that the gpio pins a pulled down when not connected.
Some times it is desireable to pull up the pin when not connected.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">define_as_input</span><span class="p">(</span><span class="n">pull_up</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="bounce">
<h2>Bounce<a class="headerlink" href="#bounce" title="Permalink to this headline">¶</a></h2>
<p>When a physical switch or button is pressed the metal connectors in the switch makes microscopic bounces until
the switch is locked in the new position.
The result of this bouncing may be several small signals on the gpio pin going on or off within a few milliseconds.
To prevent that a pin should hold its signal for certain amount of time before triggering a value change.
When defining an gpio input its is possible to set the time for bouncing and the default value is 200 milliseconds.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">define_as_input</span><span class="p">(</span><span class="n">bounce_time</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="pwm">
<h2>PWM<a class="headerlink" href="#pwm" title="Permalink to this headline">¶</a></h2>
<p>On Raspberry pi there is software emulated PWM.
Below is GPIO03 defined as pwm. The duty cycle is linked to the dashboard.
The duty cycle is a value between 0 and 100.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="kn">from</span> <span class="nn">kervi.application</span> <span class="kn">import</span> <span class="n">Application</span>
<span class="n">APP</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>

<span class="c1">#Get access to mainboard GPIO</span>
<span class="kn">from</span> <span class="nn">kervi.hal</span> <span class="kn">import</span> <span class="n">GPIO</span>

<span class="c1">#define pin as pwm with a frequency of 60 Hz and an initial duty_cycle=50%</span>
<span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">define_as_pwm</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pwm</span><span class="o">.</span><span class="n">active</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1">#Link to dashboard</span>
<span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pwm</span><span class="o">.</span><span class="n">duty_cycle</span><span class="o">.</span><span class="n">link_to_dashboard</span><span class="p">()</span>

<span class="nd">@action</span>
<span class="k">def</span> <span class="nf">app_main</span><span class="p">():</span>
    <span class="c1">#change the duty cycle. The value should be</span>
    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">pwm</span><span class="o">.</span><span class="n">duty_cycle</span><span class="o">.</span><span class="n">value</span><span class="o">=</span><span class="mi">80</span>

<span class="n">APP</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="other-gpio-devices">
<h2>Other GPIO devices<a class="headerlink" href="#other-gpio-devices" title="Permalink to this headline">¶</a></h2>
<p>If you want to use analog in out or extent the number of digital pins you will have to use a GPIO chip like the PCF8591.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kervi.application</span> <span class="k">import</span> <span class="n">Application</span>
<span class="n">APP</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">kervi_devices.gpio</span> <span class="k">import</span> <span class="n">PCF8591</span>

<span class="n">PCF8591_gpio</span> <span class="o">=</span> <span class="n">PCF8591</span><span class="o">.</span><span class="n">PCF8591Driver</span><span class="p">()</span>
<span class="n">PCF8591_gpio</span><span class="p">[</span><span class="s2">&quot;AIN0&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">link_to_dashboard</span><span class="p">()</span>

<span class="n">APP</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="scheduling">
<h2>Scheduling<a class="headerlink" href="#scheduling" title="Permalink to this headline">¶</a></h2>
<p>It is possible to schedule when to change an gpio pin.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">kervi.application</span> <span class="k">import</span> <span class="n">Application</span>
    <span class="n">APP</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>

    <span class="kn">from</span> <span class="nn">kervi.hal</span> <span class="k">import</span> <span class="n">GPIO</span>

    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">define_as_output</span><span class="p">()</span>

    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">every</span><span class="p">()</span><span class="o">.</span><span class="n">monday</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="s2">&quot;10:30&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">every</span><span class="p">()</span><span class="o">.</span><span class="n">monday</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="s2">&quot;11:30&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">every</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">monday</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="s2">&quot;10:30&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">every</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">monday</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="s2">&quot;11:30&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">every</span><span class="p">()</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="s2">&quot;10:30&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">every</span><span class="p">()</span><span class="o">.</span><span class="n">day</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="s2">&quot;11:30&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">every</span><span class="p">()</span><span class="o">.</span><span class="n">minute</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="s2">&quot;:00&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">every</span><span class="p">()</span><span class="o">.</span><span class="n">minute</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="s2">&quot;:30&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">APP</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="linking-to-dashboards">
<h2>Linking to dashboards<a class="headerlink" href="#linking-to-dashboards" title="Permalink to this headline">¶</a></h2>
<p>A gpio pin can be linked to a dashboard in the web ui.
The ui component presented depends on the gpio type.
The web ui user can change the state of the gpio pin it is defined as output other wise the ui element is read only.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">kervi.application</span> <span class="kn">import</span> <span class="n">Application</span>
    <span class="n">APP</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>

    <span class="c1">#Get access to main board GPIO</span>
    <span class="kn">from</span> <span class="nn">kervi.hal</span> <span class="kn">import</span> <span class="n">GPIO</span>

    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">define_as_input</span><span class="p">()</span>
    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">link_to_dashboard</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;button 1&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;switch&quot;</span><span class="p">)</span>

    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;GPIO11&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">define_as_output</span><span class="p">()</span>
    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;GPIO11&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">link_to_dashboard</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Light 1&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;button&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="linking-to-controllers">
<h2>Linking to controllers<a class="headerlink" href="#linking-to-controllers" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="linking-to-actions">
<h2>Linking to actions<a class="headerlink" href="#linking-to-actions" title="Permalink to this headline">¶</a></h2>
<p>GPIO pins can trigger actions.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">kervi.application</span> <span class="k">import</span> <span class="n">Application</span>
    <span class="n">APP</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>

    <span class="c1">#Get access to main board GPIO</span>
    <span class="kn">from</span> <span class="nn">kervi.hal</span> <span class="k">import</span> <span class="n">GPIO</span>

    <span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">define_as_input</span><span class="p">()</span>

    <span class="kn">from</span> <span class="nn">kervi.actions</span> <span class="k">import</span> <span class="n">action</span>

    <span class="nd">@action</span>
    <span class="k">def</span> <span class="nf">my_action</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;my action&quot;</span><span class="p">)</span>


    <span class="c1">#my action is called when gpio21 goes high</span>
    <span class="n">my_action</span><span class="o">.</span><span class="n">link_to</span><span class="p">(</span><span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">])</span>

    <span class="n">APP</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>Call an action when the value change and pass that value</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kervi.application</span> <span class="k">import</span> <span class="n">Application</span>
<span class="n">APP</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">kervi.actions</span> <span class="k">import</span> <span class="n">action</span>

<span class="nd">@action</span>
<span class="k">def</span> <span class="nf">my_action</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;my action&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">kervi_devices.gpio</span> <span class="k">import</span> <span class="n">PCF8591</span>

<span class="n">PCF8591_gpio</span> <span class="o">=</span> <span class="n">PCF8591</span><span class="o">.</span><span class="n">PCF8591Driver</span><span class="p">()</span>

<span class="c1">#Call action when ever the value on AIN0 changes and pass the value to the action.</span>
<span class="n">my_action</span><span class="o">.</span><span class="n">link_to</span><span class="p">(</span><span class="n">PCF8591_gpio</span><span class="p">[</span><span class="s2">&quot;AIN0&quot;</span><span class="p">],</span> <span class="n">pass_value</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">APP</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="action-interrupts">
<h2>Action interrupts<a class="headerlink" href="#action-interrupts" title="Permalink to this headline">¶</a></h2>
<p>Below is an example where an action is executed when gpio the pin is high and exists when the gpio pin goes low.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kervi.application</span> <span class="k">import</span> <span class="n">Application</span>
<span class="n">APP</span> <span class="o">=</span> <span class="n">Application</span><span class="p">()</span>

<span class="c1">#Get access to main board GPIO</span>
<span class="kn">from</span> <span class="nn">kervi.hal</span> <span class="k">import</span> <span class="n">GPIO</span>
<span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">define_as_input</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">kervi.actions</span> <span class="k">import</span> <span class="n">action</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="nd">@action</span>
<span class="k">def</span> <span class="nf">my_action</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;my action start&quot;</span><span class="p">)</span>

    <span class="c1">#The action decorator injects &quot;exit_action&quot;</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">exit_action</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Do action things&quot;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;my action stop&quot;</span><span class="p">)</span>

<span class="n">my_action</span><span class="o">.</span><span class="n">link_to</span><span class="p">(</span><span class="n">GPIO</span><span class="p">[</span><span class="s2">&quot;gpio21&quot;</span><span class="p">],</span> <span class="n">interrupt_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="display.html" class="btn btn-neutral float-right" title="Displays" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="motors.html" class="btn btn-neutral" title="Motors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Tim Wentzlau.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>