

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Process distribution &mdash; Kervi 0.15.0 - beta documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Distributed applications" href="distributed.html" />
    <link rel="prev" title="Sensors" href="devices/sensors.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Kervi
          

          
          </a>

          
            
            
              <div class="version">
                0.15.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getstarted.html">Get started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getstarted.html#prerequisites">prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="getstarted.html#install">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="getstarted.html#create-application">Create application</a><ul>
<li class="toctree-l3"><a class="reference internal" href="getstarted.html#single-file-application">Single file application</a></li>
<li class="toctree-l3"><a class="reference internal" href="getstarted.html#multi-process-file-application">Multi process/file application</a></li>
<li class="toctree-l3"><a class="reference internal" href="getstarted.html#start-application">Start application</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview.html#kervi-application-anatomy">Kervi application anatomy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="overview.html#single-file-application">Single file application</a><ul>
<li class="toctree-l4"><a class="reference internal" href="overview.html#application-line-1-3">Application (line 1-3)</a></li>
<li class="toctree-l4"><a class="reference internal" href="overview.html#dashboards-line-5-25">Dashboards (line 5-25)</a></li>
<li class="toctree-l4"><a class="reference internal" href="overview.html#sensors-26-39">Sensors (26-39)</a></li>
<li class="toctree-l4"><a class="reference internal" href="overview.html#controllers-line-38-96">Controllers (line 38-96)</a></li>
<li class="toctree-l4"><a class="reference internal" href="overview.html#linking-controller-inputs-line-100-108">Linking controller inputs (line 100 - 108)</a></li>
<li class="toctree-l4"><a class="reference internal" href="overview.html#linking-controller-outputs-line-110-113">Linking controller outputs (line 110 - 113)</a></li>
<li class="toctree-l4"><a class="reference internal" href="overview.html#go-into-action-line-115">Go into action (line 115)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="overview.html#multi-file-process-application">Multi file/process application</a></li>
<li class="toctree-l3"><a class="reference internal" href="overview.html#distributed-application">Distributed application</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dashboards.html">Dashboards</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dashboards.html#linking">Linking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dashboards.html#sensors-and-numbers">Sensors and numbers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dashboards.html#controller-pads">Controller pads</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dashboards.html#gpio-and-boolean-values">GPIO and boolean values</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sensors.html">Sensors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sensors.html#kervi-device-library">Kervi Device library</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensors.html#linking-sensors">Linking sensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensors.html#implementing-a-sensor-device">Implementing a sensor device</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="controllers.html">Controllers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="controllers.html#input-and-output-interfaces">Input and output interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="controllers.html#linking-controllers">Linking controllers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="signals.html">Signal handling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="signals.html#value-linking">Value linking</a></li>
<li class="toctree-l2"><a class="reference internal" href="signals.html#value-link-transformation">Value link transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="signals.html#dashboard-linking">Dashboard linking</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="actions.html">Actions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="actions.html#define-actions">Define actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html#actions-with-timeout">Actions with timeout</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html#asynchronous-action-call">Asynchronous action call</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html#interrupts">Interrupts</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html#linking-to-dashboards">Linking to dashboards</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html#linking-to-values">Linking to values</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html#system-actions">System actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html#complete-example">Complete example</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html#multi-process">Multi process</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="camera.html">Camera and video</a></li>
<li class="toctree-l1"><a class="reference internal" href="motors.html">Motors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="motors.html#dc-motors">DC motors</a></li>
<li class="toctree-l2"><a class="reference internal" href="motors.html#servo-motor">Servo motor</a></li>
<li class="toctree-l2"><a class="reference internal" href="motors.html#stepper-motors">Stepper motors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="display.html">Displays</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configuration.html#accessing-config-values-in-code">Accessing config values in code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security</a><ul>
<li class="toctree-l2"><a class="reference internal" href="security.html#simple-user-management">Simple user management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="security.html#anonymous-access">Anonymous access</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="security.html#encryption">Encryption</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hal.html">Hardware and devices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hal.html#select-platform">Select platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="hal.html#gpio">GPIO</a></li>
<li class="toctree-l2"><a class="reference internal" href="hal.html#i2c">I2C</a></li>
<li class="toctree-l2"><a class="reference internal" href="hal.html#spi">SPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="hal.html#device-library">Device library</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="devices/index.html">Device library</a><ul>
<li class="toctree-l2"><a class="reference internal" href="devices/displays.html">Displays</a><ul>
<li class="toctree-l3"><a class="reference internal" href="devices/displays.html#ssd1306-i2c">SSD1306(I2C)</a></li>
<li class="toctree-l3"><a class="reference internal" href="devices/displays.html#hd44780-i2c-pcf8574">HD44780(I2C, PCF8574)</a></li>
<li class="toctree-l3"><a class="reference internal" href="devices/displays.html#hd44780-i2c-mcp23017">HD44780(I2C, MCP23017)</a></li>
<li class="toctree-l3"><a class="reference internal" href="devices/displays.html#hd44780">HD44780</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="devices/gpio.html">GPIO</a><ul>
<li class="toctree-l3"><a class="reference internal" href="devices/gpio.html#mcp23017-i2c">MCP23017(I2C)</a></li>
<li class="toctree-l3"><a class="reference internal" href="devices/gpio.html#mcp23008-i2c">MCP23008(I2C)</a></li>
<li class="toctree-l3"><a class="reference internal" href="devices/gpio.html#pcf8574-pcf8574a-i2c">PCF8574, PCF8574A(I2C)</a></li>
<li class="toctree-l3"><a class="reference internal" href="devices/gpio.html#pcf859-i2c">PCF859(I2C)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="devices/motors.html">Motors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="devices/motors.html#ln298">LN298</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="devices/pwm.html">PWM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="devices/pwm.html#raspbery-pi">Raspbery pi</a></li>
<li class="toctree-l3"><a class="reference internal" href="devices/pwm.html#pca9685-i2c">PCA9685(I2C)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="devices/sensors.html">Sensors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="devices/sensors.html#temperature">Temperature</a><ul>
<li class="toctree-l4"><a class="reference internal" href="devices/sensors.html#cpu-temp">CPU temp</a></li>
<li class="toctree-l4"><a class="reference internal" href="devices/sensors.html#bmp085-i2c">BMP085(I2C)</a></li>
<li class="toctree-l4"><a class="reference internal" href="devices/sensors.html#ds18b20-one-wire">DS18B20(One wire)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="devices/sensors.html#pressure">Pressure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="devices/sensors.html#id1">BMP085</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="devices/sensors.html#orientation">Orientation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="devices/sensors.html#lsm9ds0-i2c">LSM9DS0(I2C)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="devices/sensors.html#light-lux">Light (lux)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="devices/sensors.html#tsl2561-i2c">TSL2561(I2C)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="devices/sensors.html#other">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="devices/sensors.html#memory">Memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="devices/sensors.html#cpu-load">CPU load</a></li>
<li class="toctree-l4"><a class="reference internal" href="devices/sensors.html#disk-use">Disk use</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Process distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributed.html">Distributed applications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="distributed.html#use-cases">Use cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="distributed.html#main-application">Main application</a></li>
<li class="toctree-l2"><a class="reference internal" href="distributed.html#application-modules">Application modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="distributed.html#application-discovery">Application discovery</a><ul>
<li class="toctree-l3"><a class="reference internal" href="distributed.html#discovery-configuration">Discovery configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="distributed.html#connection-without-auto-discovery">Connection without auto discovery</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ipc.html">Component communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Commandline tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Contribute</a><ul>
<li class="toctree-l2"><a class="reference internal" href="contribute.html#development-enviroment">Development enviroment</a></li>
<li class="toctree-l2"><a class="reference internal" href="contribute.html#github-projects">Github projects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="contribute.html#application-demo-integration-tests">Application (demo, integration tests)</a></li>
<li class="toctree-l3"><a class="reference internal" href="contribute.html#kervi-core">Kervi core</a></li>
<li class="toctree-l3"><a class="reference internal" href="contribute.html#kervi-platform-driver">Kervi platform driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="contribute.html#kervi-device-library">Kervi device library</a></li>
<li class="toctree-l3"><a class="reference internal" href="contribute.html#kervi-ui-web-dashboards">Kervi UI (Web dashboards)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="contribute.html#install-packages">Install packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="contribute.html#documentation">Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="kervi_api.html">Kervi API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dashboards_api.html">Dashboards api</a></li>
<li class="toctree-l2"><a class="reference internal" href="camera_api.html">Camera api</a></li>
<li class="toctree-l2"><a class="reference internal" href="controllers_api.html">Controllers api</a></li>
<li class="toctree-l2"><a class="reference internal" href="values_api.html">Kervi values api</a></li>
<li class="toctree-l2"><a class="reference internal" href="sensors_api.html">Sensors API</a></li>
<li class="toctree-l2"><a class="reference internal" href="display_api.html">Display api</a></li>
<li class="toctree-l2"><a class="reference internal" href="hal_gpio_api.html">GPIO API</a></li>
<li class="toctree-l2"><a class="reference internal" href="hal_i2c_api.html">I2C API</a></li>
<li class="toctree-l2"><a class="reference internal" href="hal_devices_api.html">Devices API</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Kervi</a>
        
      </nav>


      
      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Process distribution</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="process-distribution">
<h1>Process distribution<a class="headerlink" href="#process-distribution" title="Permalink to this headline">¶</a></h1>
<p>In python it is possible to have multiple threads in a process but only one is executed at any given time (due to the infamous gil lock).
This may impact the performance of your kervi application if you have a lot of sensors, cameras and controllers in your (single file) application.
Kervi makes it easy to overcome this limitation by spreading your code over more than one process and thereby makes the separated process code truly concurrent.
Another advantage is that the underlaying operative system may spread the processes over available cpu cores and that makes your application more responsive.</p>
<p>The kervi framework uses its interprocess communications system(IPC) to connect the different processes in your application and transmit sensor values and call actions commands across process boundaries.</p>
<p>The kervi framework spawns two processes of its own, one for ipc and one for the web server that servers the dashboards.</p>
<p>Code that should be executed in its own process should be placed in sub folders relative to your main kervi python script.</p>
<p>Below is the folder structure of a kervi project with multiple python modules.</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">app</span> <span class="n">root</span>
<span class="o">|-</span> <span class="n">controllers</span>
    <span class="o">|-</span> <span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>
    <span class="o">|-</span> <span class="n">fan_controller</span><span class="o">.</span><span class="n">py</span>
<span class="o">|-</span> <span class="n">sensors</span>
    <span class="o">|-</span> <span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>
    <span class="o">|-</span> <span class="n">system_sensor</span><span class="o">.</span><span class="n">py</span>
<span class="o">|-</span> <span class="n">myapp</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>The kervi application is bootstrapped in myapp.py where the modules parameter tells kervi
which modules to load.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kervi.application</span> <span class="k">import</span> <span class="n">Application</span>
<span class="kn">import</span> <span class="nn">kervi.utility.nethelper</span> <span class="k">as</span> <span class="nn">nethelper</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>

    <span class="n">APP</span> <span class="o">=</span> <span class="n">Application</span><span class="p">({</span>
        <span class="s2">&quot;modules&quot;</span><span class="p">:[</span><span class="s2">&quot;sensors&quot;</span><span class="p">,</span> <span class="s2">&quot;controllers&quot;</span><span class="p">],</span>
    <span class="p">})</span>

    <span class="nd">@action</span>
    <span class="k">def</span> <span class="nf">app_main</span><span class="p">():</span>
        <span class="n">Actions</span><span class="p">[</span><span class="s2">&quot;fan_controller.activate&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>

    <span class="nd">@action</span>
    <span class="k">def</span> <span class="nf">app_exit</span><span class="p">():</span>
        <span class="n">Actions</span><span class="p">[</span><span class="s2">&quot;fan_controller.activate&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>

    <span class="n">APP</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>When the Application.run method is called the modules in the “modules parameter” are loaded into separate processes.
In each of the loaded modules the __init__.py file bootstraps and load the components that resides in the local folder.</p>
<p>When the application has loaded the app_main action is called by the framework and the fan controller is started.
Likewise the app_exit action is called by the framework when the application terminates.</p>
<p>In this example the fan controller has its own action Activate that sets the state of the controller.
The fan controller lives in a processes separate from your myapp.py code.
Kervi detects this and transmits the action over the IPC system to the controller module code.</p>
<p>The sensors module could look like this:</p>
<p>sensors/__init__.py</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">system_sensors</span>
</pre></div>
</div>
<p>sensors/system_sensors.py</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kervi.sensors.sensor</span> <span class="k">import</span> <span class="n">Sensor</span>
<span class="kn">from</span> <span class="nn">kervi.devices.platforms.common.sensors.cpu_use</span> <span class="k">import</span> <span class="n">CPULoadSensorDeviceDriver</span>

<span class="c1">#create a sensor with id &quot;cpu_load&quot;</span>
<span class="n">CPU_SENSOR</span> <span class="o">=</span> <span class="n">Sensor</span><span class="p">(</span><span class="s2">&quot;cpu_load&quot;</span><span class="p">,</span><span class="s2">&quot;CPU&quot;</span><span class="p">,</span> <span class="n">CPULoadSensorDeviceDriver</span><span class="p">())</span>
<span class="n">CPU_SENSOR</span><span class="o">.</span><span class="n">link_to_dashboard</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">link_to_header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">CPU_SENSOR</span><span class="o">.</span><span class="n">link_to_dashboard</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;chart&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The controllers module contains the following code.</p>
<p>controllers/__init__.py</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">fan_controller</span>
</pre></div>
</div>
<p>controllers/fan_controller.py</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">kervi.controllers.controller</span> <span class="k">import</span> <span class="n">Controller</span>
<span class="kn">from</span> <span class="nn">kervi.values</span> <span class="k">import</span> <span class="n">NumberValue</span>
<span class="kn">from</span> <span class="nn">kervi.action</span> <span class="k">import</span> <span class="n">action</span>

<span class="k">class</span> <span class="nc">FanController</span><span class="p">(</span><span class="n">Controller</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Controller</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;fan_controller&quot;</span><span class="p">,</span> <span class="s2">&quot;Fan&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;temp&quot;</span><span class="p">,</span> <span class="s2">&quot;Temperature&quot;</span><span class="p">,</span> <span class="n">NumberValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="mi">150</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fan_speed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;fan_speed&quot;</span><span class="p">,</span> <span class="s2">&quot;Fanspeed&quot;</span><span class="p">,</span> <span class="n">NumberValue</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_active</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nd">@action</span>
    <span class="k">def</span> <span class="nf">activate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">active</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_active</span> <span class="o">=</span> <span class="n">active</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_calc_speed</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">input_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">changed_input</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_calc_speed</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_calc_speed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">self_active</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">value</span>
            <span class="k">if</span> <span class="n">temp</span> <span class="o">&lt;=</span> <span class="mi">20</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fan_speed</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">speed</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp</span> <span class="o">/</span> <span class="mi">80</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
                <span class="k">if</span> <span class="n">speed</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
                    <span class="n">speed</span> <span class="o">=</span> <span class="mi">100</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fan_speed</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">speed</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fan_speed</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">speed</span>

<span class="n">FAN_CONTROLLER</span> <span class="o">=</span> <span class="n">FanController</span><span class="p">()</span>

<span class="c1">#link the fan controllers temp input to cpu temperature sensor</span>
<span class="c1">#The temp sensor is loaded in another process and linked via its id</span>
<span class="n">FAN_CONTROLLER</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">link_to</span><span class="p">(</span><span class="s2">&quot;cpu_load&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>It is the last line in the example above that makes the inter process link between the sensor process and the controller process.
The kervi frame work detects that the sensor with id “cpu_load” does not live in this process and starts to listen
for value events from the sensor that are transmitted via IPC.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="distributed.html" class="btn btn-neutral float-right" title="Distributed applications" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="devices/sensors.html" class="btn btn-neutral" title="Sensors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Tim Wentzlau.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.15.0 - beta',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>